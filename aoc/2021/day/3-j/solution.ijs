(C i)*&#.(-.(C=.(+/>:#-+/))(i=."."0>cutopen 1!:1<'test.txt')) NB. Part 1 oneliner
0(]CI*-.(CI=.1 :('v=.(#~(u(>:(#y)-])x{+/y)=x&{"1)y';'(>:x)(#.@:]`(u CI)@.(1<#v))v')))"."0>cutopen 1!:1<'test.txt' NB. Part 2 oneliner

